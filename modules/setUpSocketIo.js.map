{"version":3,"sources":["../src/server/modules/setUpSocketIo.js"],"names":["Sound","require","nfc","start","setUpSocketIo","server","io","on","socket","console","log","card","id","type","play","emit","err","error"],"mappings":";;;;;;AAAA;;;;AAEA;;;;;;AAEA,IAAMA,QAAQC,QAAQ,OAAR,CAAd;AAHA;;;AAKA,IAAMC,MAAM,4BAAcC,KAAd,EAAZ;;AAEA,IAAMC,gBAAgB,SAAhBA,aAAgB,CAACC,MAAD,EAAY;AAChC,MAAMC,KAAK,sBAAOD,MAAP,CAAX;;AAEAC,KAAGC,EAAH,CAAM,YAAN,EAAoB,UAACC,MAAD,EAAY;AAC9BC,YAAQC,GAAR,CAAY,SAAZ;;AAEAF,WAAOD,EAAP,CAAU,YAAV,EAAwB,YAAM;AAC5BE,cAAQC,GAAR,CAAY,WAAZ;AACD,KAFD;;AAIA;AACAR,QAAIK,EAAJ,CAAO,YAAP,EAAqB,UAACI,IAAD,EAAU;AAC7BF,cAAQC,GAAR,eAAwBC,KAAKC,EAA7B;AACAH,cAAQC,GAAR,iBAA0BC,KAAKE,IAA/B;AACA,UAAIb,KAAJ,GAAYc,IAAZ,CAAiB,yBAAjB,EAH6B,CAGgB;AAC7CN,aAAOO,IAAP,CAAY,MAAZ,EAAoBJ,KAAKC,EAAzB;AACD,KALD;AAMA;AACAV,QAAIK,EAAJ,CAAO,UAAP,EAAmB,YAAM;AACvBE,cAAQC,GAAR,CAAY,gBAAZ;AACD,KAFD;AAGAR,QAAIK,EAAJ,CAAO,OAAP,EAAgB,UAACS,GAAD,EAAS;AACvB;AACAP,cAAQQ,KAAR,CAAc,UAAd,EAA4BD,GAA5B,EAAiC,SAAjC;AACD,KAHD;AAID,GAtBD;AAuBD,CA1BD;kBA2BeZ,a","file":"setUpSocketIo.js","sourcesContent":["import Server from 'socket.io';\n// エラー回避のためコメントアウトしています。\nimport NfcpyId from 'node-nfcpy-id';\n\nconst Sound = require('aplay');\n\nconst nfc = new NfcpyId().start();\n\nconst setUpSocketIo = (server) => {\n  const io = Server(server);\n\n  io.on('connection', (socket) => {\n    console.log('接続しました。');\n\n    socket.on('disconnect', () => {\n      console.log('接続が切れました。');\n    });\n\n    // touch scan\n    nfc.on('touchstart', (card) => {\n      console.log(`Card ID: ${card.id}`);\n      console.log(`Card Type: ${card.type}`);\n      new Sound().play('./assets/music/hoge.mp3'); // assets/musicにあるmp3ファイルを指定します。\n      socket.emit('scan', card.id);\n    });\n    // touch end\n    nfc.on('touchend', () => {\n      console.log('Card was away.');\n    });\n    nfc.on('error', (err) => {\n      // standard error output (color is red)\n      console.error('\\u001b[31m', err, '\\u001b[0m');\n    });\n  });\n};\nexport default setUpSocketIo;\n"]}